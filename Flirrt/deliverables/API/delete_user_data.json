{
  "endpoint": "/api/v1/user/{user_id}/data",
  "method": "DELETE",
  "description": "Deletes user data for privacy compliance and account closure requests",
  "content_type": "application/json",
  "authentication": "Bearer token required",
  "rate_limits": {
    "requests_per_hour": 5,
    "verification_required": true
  },
  "request": {
    "headers": {
      "Authorization": "Bearer {access_token}",
      "Content-Type": "application/json"
    },
    "path_parameters": {
      "user_id": {
        "type": "string",
        "required": true,
        "description": "Unique user identifier"
      }
    },
    "body": {
      "deletion_type": {
        "type": "string",
        "enum": ["partial", "complete"],
        "required": true,
        "description": "Scope of data deletion"
      },
      "data_categories": {
        "type": "array",
        "items": {
          "type": "string",
          "enum": ["voice_samples", "conversation_history", "personalization", "usage_analytics", "account_data"]
        },
        "description": "Specific data categories to delete (for partial deletion)"
      },
      "verification": {
        "type": "object",
        "required": true,
        "properties": {
          "email_confirmation": {
            "type": "boolean",
            "description": "User confirmed via email"
          },
          "confirmation_code": {
            "type": "string",
            "description": "6-digit verification code"
          },
          "reason": {
            "type": "string",
            "enum": ["account_closure", "privacy_request", "data_portability", "consent_withdrawal"],
            "description": "Reason for deletion request"
          }
        }
      },
      "jurisdiction": {
        "type": "string",
        "enum": ["US", "EU", "CA", "UK", "AU", "other"],
        "description": "User's legal jurisdiction for compliance"
      },
      "export_before_deletion": {
        "type": "boolean",
        "default": false,
        "description": "Generate data export before deletion"
      }
    }
  },
  "response": {
    "success": {
      "status_code": 202,
      "content_type": "application/json",
      "body": {
        "deletion_request": {
          "type": "object",
          "properties": {
            "deletion_id": {
              "type": "string",
              "description": "Unique identifier for deletion request"
            },
            "status": {
              "type": "string",
              "enum": ["initiated", "in_progress", "completed"],
              "description": "Current status of deletion"
            },
            "estimated_completion": {
              "type": "string",
              "format": "ISO8601",
              "description": "When deletion will be complete"
            },
            "data_categories_affected": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "Categories being deleted"
            }
          }
        },
        "timeline": {
          "type": "object",
          "properties": {
            "immediate_actions": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string"
                  },
                  "completed_at": {
                    "type": "string",
                    "format": "ISO8601"
                  }
                }
              }
            },
            "scheduled_actions": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "action": {
                    "type": "string"
                  },
                  "scheduled_for": {
                    "type": "string",
                    "format": "ISO8601"
                  },
                  "category": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "compliance_details": {
          "type": "object",
          "properties": {
            "applicable_laws": {
              "type": "array",
              "items": {
                "type": "string"
              }
            },
            "retention_requirements": {
              "type": "object",
              "description": "Any data that must be retained for legal reasons"
            },
            "third_party_notifications": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "service": {
                    "type": "string"
                  },
                  "notification_sent": {
                    "type": "boolean"
                  },
                  "expected_completion": {
                    "type": "string",
                    "format": "ISO8601"
                  }
                }
              }
            }
          }
        },
        "user_notifications": {
          "type": "object",
          "properties": {
            "confirmation_email_sent": {
              "type": "boolean"
            },
            "progress_updates": {
              "type": "boolean",
              "description": "Whether user will receive progress updates"
            },
            "completion_notification": {
              "type": "boolean"
            }
          }
        }
      }
    }
  },
  "example_request": {
    "curl": "curl -X DELETE https://api.vibe8.ai/v1/user/user_12345/data \\\n  -H \"Authorization: Bearer your_access_token\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"deletion_type\": \"complete\",\n    \"verification\": {\n      \"email_confirmation\": true,\n      \"confirmation_code\": \"123456\",\n      \"reason\": \"account_closure\"\n    },\n    \"jurisdiction\": \"EU\",\n    \"export_before_deletion\": true\n  }'",
    "javascript": "fetch('https://api.vibe8.ai/v1/user/user_12345/data', {\n  method: 'DELETE',\n  headers: {\n    'Authorization': 'Bearer your_access_token',\n    'Content-Type': 'application/json'\n  },\n  body: JSON.stringify({\n    deletion_type: 'complete',\n    verification: {\n      email_confirmation: true,\n      confirmation_code: '123456',\n      reason: 'account_closure'\n    },\n    jurisdiction: 'EU'\n  })\n});"
  },
  "example_response": {
    "deletion_request": {
      "deletion_id": "del_abc123def456",
      "status": "initiated",
      "estimated_completion": "2025-09-23T14:30:00Z",
      "data_categories_affected": ["voice_samples", "conversation_history", "personalization", "usage_analytics", "account_data"]
    },
    "timeline": {
      "immediate_actions": [
        {
          "action": "Account deactivation",
          "completed_at": "2025-09-22T14:30:00Z"
        },
        {
          "action": "Active sessions terminated",
          "completed_at": "2025-09-22T14:30:05Z"
        },
        {
          "action": "Cached data cleared",
          "completed_at": "2025-09-22T14:30:10Z"
        }
      ],
      "scheduled_actions": [
        {
          "action": "Voice samples deletion",
          "scheduled_for": "2025-09-23T02:00:00Z",
          "category": "voice_samples"
        },
        {
          "action": "Conversation history purge",
          "scheduled_for": "2025-09-23T02:00:00Z", 
          "category": "conversation_history"
        },
        {
          "action": "Backup data removal",
          "scheduled_for": "2025-09-29T14:30:00Z",
          "category": "backups"
        }
      ]
    },
    "compliance_details": {
      "applicable_laws": ["GDPR Article 17", "Right to Erasure"],
      "retention_requirements": {
        "audit_logs": "90 days for security compliance",
        "financial_records": "7 years for tax compliance (anonymized)"
      },
      "third_party_notifications": [
        {
          "service": "ElevenLabs",
          "notification_sent": true,
          "expected_completion": "2025-09-23T14:30:00Z"
        }
      ]
    },
    "user_notifications": {
      "confirmation_email_sent": true,
      "progress_updates": true,
      "completion_notification": true
    }
  },
  "error_responses": {
    "400_invalid_verification": {
      "error": "VERIFICATION_FAILED",
      "message": "Invalid confirmation code or email verification not completed",
      "details": {
        "verification_attempts_remaining": 2,
        "resend_code_available": true
      }
    },
    "403_insufficient_permissions": {
      "error": "INSUFFICIENT_PERMISSIONS",
      "message": "User does not have permission to delete this data",
      "details": {
        "required_verification": "additional_identity_verification"
      }
    },
    "404_user_not_found": {
      "error": "USER_NOT_FOUND",
      "message": "User ID not found or already deleted"
    },
    "409_deletion_in_progress": {
      "error": "DELETION_IN_PROGRESS",
      "message": "Deletion request already in progress for this user",
      "details": {
        "existing_deletion_id": "del_xyz789abc123",
        "estimated_completion": "2025-09-23T14:30:00Z"
      }
    },
    "429_rate_limit": {
      "error": "TOO_MANY_DELETION_REQUESTS",
      "message": "Too many deletion requests from this account",
      "details": {
        "retry_after_hours": 24
      }
    }
  }
}